IPS 


يُعد **Intrusion Prevention System (IPS)** أحد أهم أنظمة الحماية في الشبكات الحديثة، حيث يعمل على *اكتشاف* الهجمات ومحاولات الاختراق ثم *منعها فورًا* قبل أن تصل إلى هدفها. يلعب الـ IPS دورًا محوريًا في بيئات الأمن السيبراني، سواء في الشركات الكبرى أو المختبرات أو البنى التحتية السحابية.

يهدف هذا المقال إلى تقديم شرح شامل للـ IPS من حيث المفهوم، الأنواع، آلية العمل، حالات الاستخدام، والأمثلة العملية—بأسلوب مناسب للمبتدئين ومحترفي الأمن على حد سواء.

---

## **ما هو IPS؟**

**IPS (Intrusion Prevention System)** هو نظام يعمل على مستوى الشبكة أو الجهاز بهدف:

* مراقبة حركة المرور (Traffic) بشكل مستمر.
* تحليل البيانات باستخدام قواعد واستخبارات تهديدات متقدمة.
* اكتشاف السلوكيات أو الأنماط الخبيثة.
* منع الهجوم بشكل تلقائي عبر إسقاط الحزم (Packets)، أو إغلاق الجلسات، أو حظر عنوان IP.

يختلف IPS عن IDS (Intrusion Detection System) في نقطة مهمة:

* **IDS** يقوم بالكشف فقط وإرسال تنبيهات.
* **IPS** يقوم بالكشف *والمنع الفوري*.

---

## **الفرق بين IPS و IDS**

| الخاصية                | IDS                  | IPS                 |
| ---------------------- | -------------------- | ------------------- |
| وضع العمل              | Passive              | Inline Active       |
| الوظيفة                | اكتشاف وإرسال Alerts | اكتشاف ومنع الهجمات |
| تدخل مباشر في الترافيك | لا                   | نعم                 |
| مكان الوضع             | جانب الشبكة          | داخل مسار البيانات  |
| التأثير                | مراقبة               | حماية فعلية         |

---

## **هل IPS عبارة عن جهاز أم برنامج؟**

الـ IPS يمكن أن يكون:

### **1) جهاز Hardware Appliance**

مثل:

* Cisco FirePOWER
* Palo Alto IPS
* Fortinet FortiGate IPS
* Snort Appliance

يتم وضعه داخل الشبكة ويتميز بأداء عالٍ، ويغطي حماية كاملة.

### **2) برنامج Software-Based IPS**

مثل:

* Snort (كـ IPS)
* Suricata
* OSSEC HIDS

يعمل على جهاز أو سيرفر ويُستخدم عادة في المختبرات أو الشبكات الصغيرة.

---

## **كيف يعمل IPS؟**

يعمل IPS بشكل Inline بين الأجهزة بحيث تمر جميع البيانات من خلاله. وعندما يكشف سلوكًا خبيثًا يستخدم عدة طرق:

### **1) Signature-Based Detection**

البحث عن بصمات هجمات معروفة.

### **2) Anomaly-Based Detection**

مقارنة السلوك الحالي بالسلوك الطبيعي للشبكة.

### **3) Policy-Based Detection**

استخدام سياسات مكتوبة يدويًا، مثل منع مرور بروتوكولات معينة.

### **4) Heuristic Analysis**

تحليل ذكي يعتمد على الأنماط.

### **آليات المنع (Prevention Methods)**

* إسقاط الحزم (Drop Packet)
* إعادة تعيين الجلسة (Reset Connection)
* حظر عنوان IP
* إغلاق منفذ معين

---

## **أنواع IPS**

### **1) Network IPS (NIPS)**

يحمي الشبكة بالكامل.

### **2) Host IPS (HIPS)**

يتم تثبيته على جهاز واحد (سيرفر – Endpoint).

### **3) Wireless IPS (WIPS)**

يحمي الشبكات اللاسلكية.

### **4) Network Behavior Analysis (NBA)**

يكتشف السلوك غير الطبيعي مثل DDoS.

---

## **Next Generation IPS (NGIPS)**

الجيل المتطور من IPS، وأكثر قوة، ويشمل:

* تحليل Layer 7
* كشف هجمات الويب مثل XSS و SQL Injection
* دمج مع Firewall (NGFW)
* App Visibility & Control
* URL Filtering

من أمثلة NGIPS:

* Cisco FirePOWER
* Palo Alto Threat Prevention
* FortiGuard IPS

---

## **أين يتم وضع IPS داخل الشبكة؟**

عادة يتم وضع الـ IPS:

* بين الـ Firewall والشبكة الداخلية
* بين السويتش والراوتر
* داخل DMZ

الغرض: ضمان مرور كل الترافيك عبر IPS.

---

## **أمثلة لهجمات يكشفها IPS**

* DDoS / DoS Attacks
* Port Scanning مثل Nmap
* Web Attacks (SQLi, XSS)
* Buffer Overflow
* Reconnaissance Attacks
* Malware Traffic

---

## **أمثلة عملية (حقيقية)**

### **مثال: منع SQL Injection**

عندما يستقبل IPS طلبًا مثل:

```
GET /login?user=admin' OR '1'='1 --
```

يقوم بـ:

* كشف الـ Signature الخاصة بـ SQL Injection
* عمل Drop للطلب
* إرسال Alert للمسؤول

### **مثال: منع Port Scan**

عندما يلاحظ IPS وصول عدد كبير من SYN Packets من نفس الـ IP:

* يتعرف أنه Port Scanning
* يحظر عنوان الـ IP لمدة معينة

---

## **عيوب IPS**

* قد يسبب Latency بسيط لأنه يعمل Inline
* يحتاج تحديث Signatures باستمرار
* قد ينتج False Positives

---

## **IPS ضمن الامتحانات (CCNA / Security+)**

### أكثر الأسئلة شيوعًا:

* IPS يعمل Inline ويمنع الهجمات تلقائيًا
* IDS يكتشف فقط ولا يمنع
* IPS يستخدم Signature + Anomaly
* IPS يعتبر Active Device

---

## **نصائح للمبتدئين والمختبرات**

لعمل IPS في مختبر، استخدم:

* **Suricata**
* **Snort**

ومع توزيعات:

* Kali Linux
* Ubuntu Server
* Security Onion
# **Intrusion Prevention System (IPS) – دليل شامل للمبتدئين والمحترفين**

## **مقدمة**

يُعد **Intrusion Prevention System (IPS)** أحد أهم أنظمة الحماية في الشبكات الحديثة، حيث يعمل على *اكتشاف* الهجمات ومحاولات الاختراق ثم *منعها فورًا* قبل أن تصل إلى هدفها. يلعب الـ IPS دورًا محوريًا في بيئات الأمن السيبراني، سواء في الشركات الكبرى أو المختبرات أو البنى التحتية السحابية.

يهدف هذا المقال إلى تقديم شرح شامل للـ IPS من حيث المفهوم، الأنواع، آلية العمل، حالات الاستخدام، والأمثلة العملية—بأسلوب مناسب للمبتدئين ومحترفي الأمن على حد سواء.

---

## **ما هو IPS؟**

**IPS (Intrusion Prevention System)** هو نظام يعمل على مستوى الشبكة أو الجهاز بهدف:

* مراقبة حركة المرور (Traffic) بشكل مستمر.
* تحليل البيانات باستخدام قواعد واستخبارات تهديدات متقدمة.
* اكتشاف السلوكيات أو الأنماط الخبيثة.
* منع الهجوم بشكل تلقائي عبر إسقاط الحزم (Packets)، أو إغلاق الجلسات، أو حظر عنوان IP.

يختلف IPS عن IDS (Intrusion Detection System) في نقطة مهمة:

* **IDS** يقوم بالكشف فقط وإرسال تنبيهات.
* **IPS** يقوم بالكشف *والمنع الفوري*.

---

## **الفرق بين IPS و IDS**

| الخاصية                | IDS                  | IPS                 |
| ---------------------- | -------------------- | ------------------- |
| وضع العمل              | Passive              | Inline Active       |
| الوظيفة                | اكتشاف وإرسال Alerts | اكتشاف ومنع الهجمات |
| تدخل مباشر في الترافيك | لا                   | نعم                 |
| مكان الوضع             | جانب الشبكة          | داخل مسار البيانات  |
| التأثير                | مراقبة               | حماية فعلية         |

---

## **هل IPS عبارة عن جهاز أم برنامج؟**

الـ IPS يمكن أن يكون:

### **1) جهاز Hardware Appliance**

مثل:

* Cisco FirePOWER
* Palo Alto IPS
* Fortinet FortiGate IPS
* Snort Appliance

يتم وضعه داخل الشبكة ويتميز بأداء عالٍ، ويغطي حماية كاملة.

### **2) برنامج Software-Based IPS**

مثل:

* Snort (كـ IPS)
* Suricata
* OSSEC HIDS

يعمل على جهاز أو سيرفر ويُستخدم عادة في المختبرات أو الشبكات الصغيرة.

---

## **كيف يعمل IPS؟**

يعمل IPS بشكل Inline بين الأجهزة بحيث تمر جميع البيانات من خلاله. وعندما يكشف سلوكًا خبيثًا يستخدم عدة طرق:

### **1) Signature-Based Detection**

البحث عن بصمات هجمات معروفة.

### **2) Anomaly-Based Detection**

مقارنة السلوك الحالي بالسلوك الطبيعي للشبكة.

### **3) Policy-Based Detection**

استخدام سياسات مكتوبة يدويًا، مثل منع مرور بروتوكولات معينة.

### **4) Heuristic Analysis**

تحليل ذكي يعتمد على الأنماط.

### **آليات المنع (Prevention Methods)**

* إسقاط الحزم (Drop Packet)
* إعادة تعيين الجلسة (Reset Connection)
* حظر عنوان IP
* إغلاق منفذ معين

---

## **أنواع IPS**

### **1) Network IPS (NIPS)**

يحمي الشبكة بالكامل.

### **2) Host IPS (HIPS)**

يتم تثبيته على جهاز واحد (سيرفر – Endpoint).

### **3) Wireless IPS (WIPS)**

يحمي الشبكات اللاسلكية.

### **4) Network Behavior Analysis (NBA)**

يكتشف السلوك غير الطبيعي مثل DDoS.

---

## **Next Generation IPS (NGIPS)**

الجيل المتطور من IPS، وأكثر قوة، ويشمل:

* تحليل Layer 7
* كشف هجمات الويب مثل XSS و SQL Injection
* دمج مع Firewall (NGFW)
* App Visibility & Control
* URL Filtering

من أمثلة NGIPS:

* Cisco FirePOWER
* Palo Alto Threat Prevention
* FortiGuard IPS

---

## **أين يتم وضع IPS داخل الشبكة؟**

عادة يتم وضع الـ IPS:

* بين الـ Firewall والشبكة الداخلية
* بين السويتش والراوتر
* داخل DMZ

الغرض: ضمان مرور كل الترافيك عبر IPS.

---

## **أمثلة لهجمات يكشفها IPS**

* DDoS / DoS Attacks
* Port Scanning مثل Nmap
* Web Attacks (SQLi, XSS)
* Buffer Overflow
* Reconnaissance Attacks
* Malware Traffic

---

## **أمثلة عملية (حقيقية)**

### **مثال: منع SQL Injection**

عندما يستقبل IPS طلبًا مثل:

```
GET /login?user=admin' OR '1'='1 --
```

يقوم بـ:

* كشف الـ Signature الخاصة بـ SQL Injection
* عمل Drop للطلب
* إرسال Alert للمسؤول

### **مثال: منع Port Scan**

عندما يلاحظ IPS وصول عدد كبير من SYN Packets من نفس الـ IP:

* يتعرف أنه Port Scanning
* يحظر عنوان الـ IP لمدة معينة

---

## **عيوب IPS**

* قد يسبب Latency بسيط لأنه يعمل Inline
* يحتاج تحديث Signatures باستمرار
* قد ينتج False Positives

---

## **IPS ضمن الامتحانات (CCNA / Security+)**

### أكثر الأسئلة شيوعًا:

* IPS يعمل Inline ويمنع الهجمات تلقائيًا
* IDS يكتشف فقط ولا يمنع
* IPS يستخدم Signature + Anomaly
* IPS يعتبر Active Device

---

## **نصائح للمبتدئين والمختبرات**

لعمل IPS في مختبر، استخدم:

* **Suricata**
* **Snort**

ومع توزيعات:

* Kali Linux
* Ubuntu Server
* Security Onion


* IPS نظام حماية متقدم يمنع الهجمات مباشرة.
* يمكن أن يكون جهاز أو برنامج.
* يعمل inline ويحلل الترافيك.
* جزء أساسي من بيئة Blue Team.
* ضروري لفهم هجمات الـ Red Team أيضًا.

---

## **ملاحظات للاستخدام في GitHub**

* يمكنك نسخ هذا المقال كما هو.
* يمكنك إضافة صور أو رسومات تخطيطية من عندك.
* المقال منظم بالكامل وفق Markdown.


* IPS نظام حماية متقدم يمنع الهجمات مباشرة.
* يمكن أن يكون جهاز أو برنامج.
* يعمل inline ويحلل الترافيك.
* جزء أساسي من بيئة Blue Team.
* ضروري لفهم هجمات الـ Red Team أيضًا.
